# 🚀 项目启动说明

## ✅ 已完成的准备工作

我已经为您：
1. ✅ 创建了完整的项目结构
2. ✅ 配置了后端 `.env` 文件
3. ✅ 创建了必要的目录（uploads, outputs）
4. ✅ 后端服务器正在启动...

## 📋 启动前检查清单

### 1. MySQL 数据库设置

**重要**: 在启动前，您需要：

```sql
-- 1. 打开 MySQL 命令行或 MySQL Workbench
-- 2. 创建数据库
CREATE DATABASE video_process_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 3. 验证数据库已创建
SHOW DATABASES;
```

**如果 MySQL 有密码**，编辑 `backend/.env` 文件，修改：
```env
DB_PASSWORD=你的MySQL密码
```

### 2. 运行数据库迁移

```bash
cd backend
npm run migrate
```

应该看到：
```
✅ Database migration completed successfully!
```

### 3. 启动后端（两种方式）

**方式 1: Windows 批处理脚本（推荐）**
```bash
双击运行: backend/START.bat
```

**方式 2: 手动启动**
```bash
cd backend
npm run dev
```

成功启动后应该看到：
```
✅ Database connection established successfully.
✅ Database models synchronized
✅ File cleanup schedule started
🚀 Server is running on port 5000
📝 Environment: development
🌐 API URL: http://localhost:5000
```

### 4. 启动前端

打开新的命令行窗口：

```bash
cd frontend
npm install    # 首次运行需要安装依赖
npm run dev
```

成功启动后：
```
ready - started server on 0.0.0.0:3000
```

## 🌐 访问应用

- **前端**: http://localhost:3000
- **后端 API**: http://localhost:5000
- **健康检查**: http://localhost:5000/health

## ❌ 常见问题排查

### 问题 1: 后端无法连接数据库

**错误信息**: "Unable to connect to the database"

**解决方案**:
1. 确保 MySQL 服务正在运行
   ```bash
   # Windows: 在服务管理器中启动 MySQL
   # 或使用命令: net start MySQL
   ```

2. 检查 `backend/.env` 中的数据库配置：
   - DB_HOST=localhost
   - DB_PORT=3306  
   - DB_USER=root
   - DB_PASSWORD=你的密码（如果有）

3. 测试 MySQL 连接：
   ```bash
   mysql -u root -p
   ```

### 问题 2: 数据库不存在

**错误信息**: "Unknown database 'video_process_db'"

**解决方案**:
```sql
CREATE DATABASE video_process_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 问题 3: 端口被占用

**错误信息**: "Port 5000 is already in use"

**解决方案**:

选项 A: 修改端口
编辑 `backend/.env`:
```env
PORT=5001
```

选项 B: 关闭占用端口的程序
```bash
# 查找占用端口的进程
netstat -ano | findstr :5000

# 结束进程
taskkill /PID <进程ID> /F
```

### 问题 4: 前端无法连接后端

**解决方案**:
1. 确保后端正在运行（访问 http://localhost:5000/health）
2. 检查前端环境变量（如果有 .env.local 文件）
3. 清除浏览器缓存并重新加载

## 📝 快速测试流程

### 1. 测试后端 API

打开浏览器或使用 curl：
```bash
# 健康检查
curl http://localhost:5000/health

# 预期响应:
# {"status":"ok","message":"Server is running"}
```

### 2. 测试前端

访问 http://localhost:3000，您应该看到：
- ✅ 现代化的首页
- ✅ 登录/注册按钮
- ✅ 功能介绍

### 3. 测试完整流程

1. 点击"注册"按钮
2. 填写注册信息：
   - 姓名: 测试用户
   - 邮箱: test@example.com
   - 密码: 123456
3. 注册成功后应自动跳转到仪表板
4. 点击"视频处理"
5. 上传一个测试视频
6. 选择处理类型（如"格式转换"）
7. 点击"开始处理"
8. 等待处理完成
9. 下载处理结果

## 🔧 高级配置

### Google OAuth 登录（可选）

如果需要 Google 登录功能：

1. 访问 [Google Cloud Console](https://console.cloud.google.com/)
2. 创建 OAuth 2.0 客户端 ID
3. 配置回调 URL: `http://localhost:5000/api/auth/google/callback`
4. 编辑 `backend/.env`:
   ```env
   GOOGLE_CLIENT_ID=你的Client ID
   GOOGLE_CLIENT_SECRET=你的Client Secret
   ```

### FFmpeg 安装（处理功能必需）

```bash
# Windows (使用 Chocolatey)
choco install ffmpeg

# 验证安装
ffmpeg -version
```

## 📚 项目文档

- `README.md` - 项目总览
- `QUICKSTART.md` - 10分钟快速入门
- `TESTING.md` - 测试指南
- `DEPLOYMENT.md` - 部署指南
- `backend/README.md` - 后端详细文档
- `frontend/README.md` - 前端详细文档
- `backend/SETUP.md` - 后端启动问题排查

## 🎯 下一步

1. ✅ 启动后端和前端
2. 📝 测试用户注册和登录
3. 🎬 测试视频/图片处理功能
4. 📊 查看处理历史
5. 🚀 准备部署到生产环境（参考 DEPLOYMENT.md）

## 💡 提示

- 首次运行建议使用小文件（<50MB）测试
- 处理大文件时间较长，请耐心等待
- 所有处理后的文件会在24小时后自动清理
- Google OAuth 是可选的，不影响邮箱密码登录

## 🆘 需要帮助？

如果遇到问题：
1. 查看对应的文档（SETUP.md, TESTING.md）
2. 检查后端和前端的控制台输出
3. 确认数据库连接正常
4. 参考常见问题排查部分

祝您使用愉快！🎉

